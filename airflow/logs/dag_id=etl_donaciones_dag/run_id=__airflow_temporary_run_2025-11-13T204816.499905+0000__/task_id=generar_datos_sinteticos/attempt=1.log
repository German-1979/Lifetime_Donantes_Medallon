[2025-11-13T20:48:24.189+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-11-13T20:48:24.286+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_donaciones_dag.generar_datos_sinteticos __airflow_temporary_run_2025-11-13T20:48:16.499905+00:00__ [queued]>
[2025-11-13T20:48:24.304+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_donaciones_dag.generar_datos_sinteticos __airflow_temporary_run_2025-11-13T20:48:16.499905+00:00__ [queued]>
[2025-11-13T20:48:24.306+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-11-13T20:48:24.334+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): generar_datos_sinteticos> on 2025-11-13 00:00:00+00:00
[2025-11-13T20:48:24.374+0000] {standard_task_runner.py:64} INFO - Started process 1162 to run task
[2025-11-13T20:48:24.382+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'etl_donaciones_dag', 'generar_datos_sinteticos', '__***_temporary_run_2025-11-13T20:48:16.499905+00:00__', '--job-id', '35', '--raw', '--subdir', 'DAGS_FOLDER/etl_donaciones_dag.py', '--cfg-path', '/tmp/tmplncdhtw_']
[2025-11-13T20:48:24.387+0000] {standard_task_runner.py:91} INFO - Job 35: Subtask generar_datos_sinteticos
[2025-11-13T20:48:24.574+0000] {task_command.py:426} INFO - Running <TaskInstance: etl_donaciones_dag.generar_datos_sinteticos __airflow_temporary_run_2025-11-13T20:48:16.499905+00:00__ [running]> on host b9eedff8ec6c
[2025-11-13T20:48:24.755+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='german' AIRFLOW_CTX_DAG_ID='etl_donaciones_dag' AIRFLOW_CTX_TASK_ID='generar_datos_sinteticos' AIRFLOW_CTX_EXECUTION_DATE='2025-11-13T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='__***_temporary_run_2025-11-13T20:48:16.499905+00:00__'
[2025-11-13T20:48:24.757+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-11-13T20:48:24.794+0000] {logging_mixin.py:188} INFO - Efectividad promedio ponderada: 78.24%
[2025-11-13T20:48:24.794+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-01...
[2025-11-13T20:48:24.927+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 980
[2025-11-13T20:48:24.928+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 20
[2025-11-13T20:48:24.929+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 20
[2025-11-13T20:48:24.929+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-02...
[2025-11-13T20:48:25.112+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 1941
[2025-11-13T20:48:25.113+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 39
[2025-11-13T20:48:25.114+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 59
[2025-11-13T20:48:25.115+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-03...
[2025-11-13T20:48:25.333+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 2883
[2025-11-13T20:48:25.335+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 58
[2025-11-13T20:48:25.336+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 117
[2025-11-13T20:48:25.337+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-04...
[2025-11-13T20:48:25.523+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 3806
[2025-11-13T20:48:25.524+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 77
[2025-11-13T20:48:25.525+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 194
[2025-11-13T20:48:25.526+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-05...
[2025-11-13T20:48:25.756+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 4710
[2025-11-13T20:48:25.757+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 96
[2025-11-13T20:48:25.758+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 290
[2025-11-13T20:48:25.758+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-06...
[2025-11-13T20:48:26.082+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 5596
[2025-11-13T20:48:26.084+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 114
[2025-11-13T20:48:26.085+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 404
[2025-11-13T20:48:26.088+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-07...
[2025-11-13T20:48:26.562+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 6465
[2025-11-13T20:48:26.563+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 131
[2025-11-13T20:48:26.564+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 535
[2025-11-13T20:48:26.565+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-08...
[2025-11-13T20:48:26.943+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 7316
[2025-11-13T20:48:26.944+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 149
[2025-11-13T20:48:26.945+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 684
[2025-11-13T20:48:26.946+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-09...
[2025-11-13T20:48:27.318+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 8150
[2025-11-13T20:48:27.319+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 166
[2025-11-13T20:48:27.319+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 850
[2025-11-13T20:48:27.320+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-10...
[2025-11-13T20:48:27.707+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 8967
[2025-11-13T20:48:27.708+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 183
[2025-11-13T20:48:27.709+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 1033
[2025-11-13T20:48:27.709+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-11...
[2025-11-13T20:48:28.141+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 9768
[2025-11-13T20:48:28.142+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 199
[2025-11-13T20:48:28.143+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 1232
[2025-11-13T20:48:28.143+0000] {logging_mixin.py:188} INFO - 
Procesando 2024-12...
[2025-11-13T20:48:28.650+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 10553
[2025-11-13T20:48:28.652+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 215
[2025-11-13T20:48:28.652+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 1447
[2025-11-13T20:48:28.653+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-01...
[2025-11-13T20:48:29.419+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 11322
[2025-11-13T20:48:29.421+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 231
[2025-11-13T20:48:29.422+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 1678
[2025-11-13T20:48:29.426+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-02...
[2025-11-13T20:48:30.020+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 12076
[2025-11-13T20:48:30.022+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 246
[2025-11-13T20:48:30.023+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 1924
[2025-11-13T20:48:30.024+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-03...
[2025-11-13T20:48:30.571+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 12815
[2025-11-13T20:48:30.573+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 261
[2025-11-13T20:48:30.575+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 2185
[2025-11-13T20:48:30.576+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-04...
[2025-11-13T20:48:31.308+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 13539
[2025-11-13T20:48:31.311+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 276
[2025-11-13T20:48:31.312+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 2461
[2025-11-13T20:48:31.313+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-05...
[2025-11-13T20:48:32.210+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 14249
[2025-11-13T20:48:32.212+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 290
[2025-11-13T20:48:32.213+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 2751
[2025-11-13T20:48:32.214+0000] {logging_mixin.py:188} INFO - 
Procesando 2025-06...
[2025-11-13T20:48:32.667+0000] {logging_mixin.py:188} INFO -   Activos al final del mes: 14945
[2025-11-13T20:48:32.669+0000] {logging_mixin.py:188} INFO -   Fugados en este mes: 304
[2025-11-13T20:48:32.670+0000] {logging_mixin.py:188} INFO -   Total fugados acumulados: 3055
[2025-11-13T20:48:33.878+0000] {logging_mixin.py:188} INFO - 
======================================================================
[2025-11-13T20:48:33.879+0000] {logging_mixin.py:188} INFO - RESUMEN DE DATOS GENERADOS
[2025-11-13T20:48:33.879+0000] {logging_mixin.py:188} INFO - ======================================================================
[2025-11-13T20:48:33.880+0000] {logging_mixin.py:188} INFO - Total de registros: 153,136
[2025-11-13T20:48:33.897+0000] {logging_mixin.py:188} INFO - Socios únicos totales: 18,000
[2025-11-13T20:48:33.898+0000] {logging_mixin.py:188} INFO - Socios activos al final: 14,945
[2025-11-13T20:48:33.899+0000] {logging_mixin.py:188} INFO - Socios fugados totales: 3,055
[2025-11-13T20:48:33.899+0000] {logging_mixin.py:188} INFO - 
Distribución por Método de Pago:
[2025-11-13T20:48:33.921+0000] {logging_mixin.py:188} INFO - Cuenta Rut          10794
Cuenta Vista         3228
Cuenta Corriente     2129
Tarjeta Crédito      1849
Name: count, dtype: int64
[2025-11-13T20:48:33.922+0000] {logging_mixin.py:188} INFO - 
Porcentajes:
[2025-11-13T20:48:33.931+0000] {logging_mixin.py:188} INFO - Cuenta Rut          59.97
Cuenta Vista        17.93
Cuenta Corriente    11.83
Tarjeta Crédito     10.27
Name: count, dtype: float64
[2025-11-13T20:48:33.932+0000] {logging_mixin.py:188} INFO - 
Distribución por Estrategia:
[2025-11-13T20:48:33.947+0000] {logging_mixin.py:188} INFO - Face to Face     14474
Telemarketing     3526
Name: count, dtype: int64
[2025-11-13T20:48:33.948+0000] {logging_mixin.py:188} INFO - 
Porcentajes:
[2025-11-13T20:48:33.950+0000] {logging_mixin.py:188} INFO - Face to Face     80.41
Telemarketing    19.59
Name: count, dtype: float64
[2025-11-13T20:48:33.974+0000] {logging_mixin.py:188} INFO - 
Análisis de Fugados:
[2025-11-13T20:48:33.976+0000] {logging_mixin.py:188} INFO - Fugados que NUNCA donaron: 3055 (100.0%)
[2025-11-13T20:48:33.977+0000] {logging_mixin.py:188} INFO - Fugados que SÍ donaron: 0 (0.0%)
[2025-11-13T20:48:33.978+0000] {logging_mixin.py:188} INFO - 
======================================================================
[2025-11-13T20:48:33.978+0000] {logging_mixin.py:188} INFO - RESUMEN POR MES
[2025-11-13T20:48:33.979+0000] {logging_mixin.py:188} INFO - ======================================================================
[2025-11-13T20:48:34.232+0000] {logging_mixin.py:188} INFO -                   Total_Donaciones  ...  Tasa_Exito_%
Año_Mes_Donacion                    ...              
2024-01                  6700000.0  ...         77.10
2024-02                 13180000.0  ...         76.57
2024-03                 18992000.0  ...         75.01
2024-04                 25635000.0  ...         77.08
2024-05                 31155000.0  ...         76.07
2024-06                 36889000.0  ...         75.95
2024-07                 43490000.0  ...         77.30
2024-08                 48802000.0  ...         76.69
2024-09                 54765000.0  ...         77.14
2024-10                 59509000.0  ...         75.63
2024-11                 65336000.0  ...         76.54
2024-12                 70369000.0  ...         76.45
2025-01                 75176000.0  ...         76.24
2025-02                 80823000.0  ...         76.68
2025-03                 85539000.0  ...         76.76
2025-04                 90935000.0  ...         76.99
2025-05                 95329000.0  ...         76.92
2025-06                 99363000.0  ...         76.44

[18 rows x 6 columns]
[2025-11-13T20:48:34.235+0000] {logging_mixin.py:188} INFO - 
======================================================================
[2025-11-13T20:48:34.238+0000] {logging_mixin.py:188} INFO - VERIFICACIÓN: ENERO 2024
[2025-11-13T20:48:34.238+0000] {logging_mixin.py:188} INFO - ======================================================================
[2025-11-13T20:48:34.279+0000] {logging_mixin.py:188} INFO - Donantes únicos: 1000
[2025-11-13T20:48:34.280+0000] {logging_mixin.py:188} INFO - Donaciones exitosas: 771
[2025-11-13T20:48:34.281+0000] {logging_mixin.py:188} INFO - Cobros fallidos: 225
[2025-11-13T20:48:34.282+0000] {logging_mixin.py:188} INFO - Fugados sin donación (monto=NaN): 4
[2025-11-13T20:48:34.283+0000] {logging_mixin.py:188} INFO - Tasa de éxito: 77.10%
[2025-11-13T20:48:34.798+0000] {local_task_job_runner.py:313} WARNING - State of this instance has been externally set to None. Terminating instance.
[2025-11-13T20:48:34.814+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
[2025-11-13T20:48:34.862+0000] {process_utils.py:132} INFO - Sending 15 to group 1162. PIDs of all processes in the group: [1162]
[2025-11-13T20:48:34.864+0000] {process_utils.py:87} INFO - Sending the signal 15 to group 1162
[2025-11-13T20:48:34.866+0000] {taskinstance.py:2611} ERROR - Received SIGTERM. Terminating subprocesses.
[2025-11-13T20:48:34.876+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-11-13T20:48:34.965+0000] {taskinstance.py:2905} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 465, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 432, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/baseoperator.py", line 401, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 235, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 252, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/scripts/generacion_datos_sinteticos.py", line 288, in generar_datos_sinteticos
    df.to_csv(ruta_csv, index=False, encoding='utf-8-sig')
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/core/generic.py", line 3902, in to_csv
    return DataFrameRenderer(formatter).to_csv(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/formats/format.py", line 1152, in to_csv
    csv_formatter.save()
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/formats/csvs.py", line 266, in save
    self._save()
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/formats/csvs.py", line 271, in _save
    self._save_body()
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/formats/csvs.py", line 309, in _save_body
    self._save_chunk(start_i, end_i)
  File "/home/airflow/.local/lib/python3.11/site-packages/pandas/io/formats/csvs.py", line 320, in _save_chunk
    libwriters.write_csv_rows(
  File "writers.pyx", line 72, in pandas._libs.writers.write_csv_rows
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 2613, in signal_handler
    raise AirflowTaskTerminated("Task received SIGTERM signal")
airflow.exceptions.AirflowTaskTerminated: Task received SIGTERM signal
[2025-11-13T20:48:35.022+0000] {taskinstance.py:1206} INFO - Marking task as FAILED. dag_id=etl_donaciones_dag, task_id=generar_datos_sinteticos, run_id=__***_temporary_run_2025-11-13T20:48:16.499905+00:00__, execution_date=20251113T000000, start_date=20251113T204824, end_date=20251113T204835
[2025-11-13T20:48:35.162+0000] {standard_task_runner.py:110} ERROR - Failed to execute job 35 for task generar_datos_sinteticos ((psycopg2.errors.ForeignKeyViolation) insert or update on table "task_fail" violates foreign key constraint "task_fail_ti_fkey"
DETAIL:  Key (dag_id, task_id, run_id, map_index)=(etl_donaciones_dag, generar_datos_sinteticos, __airflow_temporary_run_2025-11-13T20:48:16.499905+00:00__, -1) is not present in table "task_instance".

[SQL: INSERT INTO task_fail (task_id, dag_id, run_id, map_index, start_date, end_date, duration) VALUES (%(task_id)s, %(dag_id)s, %(run_id)s, %(map_index)s, %(start_date)s, %(end_date)s, %(duration)s) RETURNING task_fail.id]
[parameters: {'task_id': 'generar_datos_sinteticos', 'dag_id': 'etl_donaciones_dag', 'run_id': '__airflow_temporary_run_2025-11-13T20:48:16.499905+00:00__', 'map_index': -1, 'start_date': datetime.datetime(2025, 11, 13, 20, 48, 24, 287060, tzinfo=Timezone('UTC')), 'end_date': datetime.datetime(2025, 11, 13, 20, 48, 35, 10898, tzinfo=Timezone('UTC')), 'duration': 10}]
(Background on this error at: https://sqlalche.me/e/14/gkpj); 1162)
[2025-11-13T20:48:35.323+0000] {process_utils.py:80} INFO - Process psutil.Process(pid=1162, status='terminated', exitcode=1, started='20:48:23') (1162) terminated with exit code 1
