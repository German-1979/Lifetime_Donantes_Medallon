[2025-11-13T20:26:20.958+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-11-13T20:26:21.008+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_donaciones_dag.procesar_silver manual__2025-11-13T20:25:47+00:00 [queued]>
[2025-11-13T20:26:21.019+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_donaciones_dag.procesar_silver manual__2025-11-13T20:25:47+00:00 [queued]>
[2025-11-13T20:26:21.021+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-11-13T20:26:21.038+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): procesar_silver> on 2025-11-13 20:25:47+00:00
[2025-11-13T20:26:21.057+0000] {standard_task_runner.py:64} INFO - Started process 404 to run task
[2025-11-13T20:26:21.062+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'etl_donaciones_dag', 'procesar_silver', 'manual__2025-11-13T20:25:47+00:00', '--job-id', '16', '--raw', '--subdir', 'DAGS_FOLDER/etl_donaciones_dag.py', '--cfg-path', '/tmp/tmpcjavurzm']
[2025-11-13T20:26:21.065+0000] {standard_task_runner.py:91} INFO - Job 16: Subtask procesar_silver
[2025-11-13T20:26:21.155+0000] {task_command.py:426} INFO - Running <TaskInstance: etl_donaciones_dag.procesar_silver manual__2025-11-13T20:25:47+00:00 [running]> on host b9eedff8ec6c
[2025-11-13T20:26:21.314+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='german' AIRFLOW_CTX_DAG_ID='etl_donaciones_dag' AIRFLOW_CTX_TASK_ID='procesar_silver' AIRFLOW_CTX_EXECUTION_DATE='2025-11-13T20:25:47+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-11-13T20:25:47+00:00'
[2025-11-13T20:26:21.315+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-11-13T20:26:21.342+0000] {logging_mixin.py:188} INFO - ✓ Archivo encontrado en Bronze: /opt/***/scripts/../layer/bronze/donantes_bronze.parquet
[2025-11-13T20:26:21.697+0000] {logging_mixin.py:188} INFO - ✓ Archivo leído correctamente. Registros cargados: 153136
[2025-11-13T20:26:21.699+0000] {logging_mixin.py:188} INFO - 
--- Primeros 10 registros ---
[2025-11-13T20:26:21.737+0000] {logging_mixin.py:188} INFO -   Id_donante       Método_Pago  ... Año_Mes_Donacion Año_Mes_Fuga
0    D000031      Cuenta Vista  ...          2024-01          NaT
1    D000036      Cuenta Vista  ...          2024-01          NaT
2    D000066  Cuenta Corriente  ...          2024-01      2024-03
3    D000068        Cuenta Rut  ...          2024-01          NaT
4    D000202        Cuenta Rut  ...          2024-01      2024-01
5    D000249        Cuenta Rut  ...          2024-01      2025-03
6    D000264   Tarjeta Crédito  ...          2024-01          NaT
7    D000291        Cuenta Rut  ...          2024-01      2024-03
8    D000299        Cuenta Rut  ...          2024-01          NaT
9    D000303        Cuenta Rut  ...          2024-01      2024-01

[10 rows x 11 columns]
[2025-11-13T20:26:21.738+0000] {logging_mixin.py:188} INFO - 
--- Tipos de datos por columna ---
[2025-11-13T20:26:21.739+0000] {logging_mixin.py:188} INFO - Id_donante           object
Método_Pago          object
Estrategia           object
Fecha_Creacion       object
Fecha_Pago           object
Monto_Donacion      float64
Status_Socio         object
Fecha_Fuga           object
Año_Mes_Creacion     object
Año_Mes_Donacion     object
Año_Mes_Fuga         object
dtype: object
[2025-11-13T20:26:22.067+0000] {logging_mixin.py:188} INFO - 
--- Primeros 10 registros de los datos pivoteados ---
[2025-11-13T20:26:22.092+0000] {logging_mixin.py:188} INFO -   Id_donante      Método_Pago    Estrategia  ...  2025-04 2025-05  2025-06
0    D000001  Tarjeta Crédito  Face to Face  ...   6000.0  6000.0   6000.0
1    D000002  Tarjeta Crédito  Face to Face  ...   7000.0  7000.0      0.0
2    D000003  Tarjeta Crédito  Face to Face  ...      0.0     0.0      0.0
3    D000004  Tarjeta Crédito  Face to Face  ...   7000.0  7000.0   7000.0
4    D000005       Cuenta Rut  Face to Face  ...   7000.0  7000.0   7000.0
5    D000006     Cuenta Vista  Face to Face  ...   8000.0  8000.0   8000.0
6    D000007       Cuenta Rut  Face to Face  ...  23000.0     0.0  23000.0
7    D000008       Cuenta Rut  Face to Face  ...      0.0  8000.0   8000.0
8    D000009  Tarjeta Crédito  Face to Face  ...      0.0     0.0      0.0
9    D000010       Cuenta Rut  Face to Face  ...      0.0     0.0      0.0

[10 rows x 23 columns]
[2025-11-13T20:26:22.187+0000] {logging_mixin.py:188} INFO - 
✓ Datos procesados y guardados en: /opt/***/scripts/../layer/silver/donantes_silver.parquet
[2025-11-13T20:26:22.198+0000] {logging_mixin.py:188} INFO - ✓ Archivo indicador creado: /opt/***/scripts/../layer/silver/donantes_silver.py
[2025-11-13T20:26:22.199+0000] {logging_mixin.py:188} INFO - 
--- PROCESO SILVER FINALIZADO ---
[2025-11-13T20:26:22.200+0000] {logging_mixin.py:188} INFO - Registros finales: 18000
[2025-11-13T20:26:22.200+0000] {logging_mixin.py:188} INFO - Columnas: ['Id_donante', 'Método_Pago', 'Estrategia', 'Status_Socio', 'Año_Mes_Creacion', '2024-01', '2024-02', '2024-03', '2024-04', '2024-05', '2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', '2024-12', '2025-01', '2025-02', '2025-03', '2025-04', '2025-05', '2025-06']
[2025-11-13T20:26:22.217+0000] {python.py:237} INFO - Done. Returned value was:       Id_donante       Método_Pago    Estrategia  ... 2025-04 2025-05  2025-06
0        D000001   Tarjeta Crédito  Face to Face  ...  6000.0  6000.0   6000.0
1        D000002   Tarjeta Crédito  Face to Face  ...  7000.0  7000.0      0.0
2        D000003   Tarjeta Crédito  Face to Face  ...     0.0     0.0      0.0
3        D000004   Tarjeta Crédito  Face to Face  ...  7000.0  7000.0   7000.0
4        D000005        Cuenta Rut  Face to Face  ...  7000.0  7000.0   7000.0
...          ...               ...           ...  ...     ...     ...      ...
17995    D017996        Cuenta Rut  Face to Face  ...     0.0     0.0   8000.0
17996    D017997   Tarjeta Crédito  Face to Face  ...     0.0     0.0  21000.0
17997    D017998      Cuenta Vista  Face to Face  ...     0.0     0.0   6000.0
17998    D017999      Cuenta Vista  Face to Face  ...     0.0     0.0   6000.0
17999    D018000  Cuenta Corriente  Face to Face  ...     0.0     0.0   8000.0

[18000 rows x 23 columns]
[2025-11-13T20:26:22.285+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-11-13T20:26:22.439+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=etl_donaciones_dag, task_id=procesar_silver, run_id=manual__2025-11-13T20:25:47+00:00, execution_date=20251113T202547, start_date=20251113T202621, end_date=20251113T202622
[2025-11-13T20:26:22.481+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2025-11-13T20:26:22.516+0000] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-13T20:26:22.519+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
