[2025-11-14T02:50:30.697+0000] {local_task_job_runner.py:120} INFO - ::group::Pre task execution logs
[2025-11-14T02:50:30.763+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: etl_donaciones_dag.procesar_silver scheduled__2025-11-14T02:47:00+00:00 [queued]>
[2025-11-14T02:50:30.784+0000] {taskinstance.py:2076} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: etl_donaciones_dag.procesar_silver scheduled__2025-11-14T02:47:00+00:00 [queued]>
[2025-11-14T02:50:30.786+0000] {taskinstance.py:2306} INFO - Starting attempt 1 of 2
[2025-11-14T02:50:30.809+0000] {taskinstance.py:2330} INFO - Executing <Task(PythonOperator): procesar_silver> on 2025-11-14 02:47:00+00:00
[2025-11-14T02:50:30.825+0000] {standard_task_runner.py:64} INFO - Started process 2105 to run task
[2025-11-14T02:50:30.831+0000] {standard_task_runner.py:90} INFO - Running: ['***', 'tasks', 'run', 'etl_donaciones_dag', 'procesar_silver', 'scheduled__2025-11-14T02:47:00+00:00', '--job-id', '117', '--raw', '--subdir', 'DAGS_FOLDER/etl_donaciones_dag.py', '--cfg-path', '/tmp/tmpbtm9pgw4']
[2025-11-14T02:50:30.839+0000] {standard_task_runner.py:91} INFO - Job 117: Subtask procesar_silver
[2025-11-14T02:50:31.038+0000] {task_command.py:426} INFO - Running <TaskInstance: etl_donaciones_dag.procesar_silver scheduled__2025-11-14T02:47:00+00:00 [running]> on host 130331ed4780
[2025-11-14T02:50:31.272+0000] {taskinstance.py:2648} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='german' AIRFLOW_CTX_DAG_ID='etl_donaciones_dag' AIRFLOW_CTX_TASK_ID='procesar_silver' AIRFLOW_CTX_EXECUTION_DATE='2025-11-14T02:47:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-11-14T02:47:00+00:00'
[2025-11-14T02:50:31.276+0000] {taskinstance.py:430} INFO - ::endgroup::
[2025-11-14T02:50:31.342+0000] {logging_mixin.py:188} INFO - ✓ Archivo encontrado en Bronze: /opt/***/scripts/../layer/bronze/donantes_bronze.parquet
[2025-11-14T02:50:31.844+0000] {logging_mixin.py:188} INFO - ✓ Archivo leído correctamente. Registros cargados: 258764
[2025-11-14T02:50:31.845+0000] {logging_mixin.py:188} INFO - 
--- Primeros 10 registros ---
[2025-11-14T02:50:31.906+0000] {logging_mixin.py:188} INFO -   Id_donante      Método_Pago  ... Año_Mes_Donacion Año_Mes_Fuga
0    D000006     Cuenta Vista  ...          2023-06          NaT
1    D000034     Cuenta Vista  ...          2023-06          NaT
2    D000061     Cuenta Vista  ...          2023-06          NaT
3    D000084       Cuenta Rut  ...          2023-06          NaT
4    D000089       Cuenta Rut  ...          2023-06      2023-06
5    D000119       Cuenta Rut  ...          2023-06      2024-02
6    D000302       Cuenta Rut  ...          2023-06          NaT
7    D000317       Cuenta Rut  ...          2023-06          NaT
8    D000344  Tarjeta Crédito  ...          2023-06      2023-12
9    D000352       Cuenta Rut  ...          2023-06      2024-01

[10 rows x 11 columns]
[2025-11-14T02:50:31.907+0000] {logging_mixin.py:188} INFO - 
--- Tipos de datos por columna ---
[2025-11-14T02:50:31.908+0000] {logging_mixin.py:188} INFO - Id_donante           object
Método_Pago          object
Estrategia           object
Fecha_Creacion       object
Fecha_Pago           object
Monto_Donacion      float64
Status_Socio         object
Fecha_Fuga           object
Año_Mes_Creacion     object
Año_Mes_Donacion     object
Año_Mes_Fuga         object
dtype: object
[2025-11-14T02:50:32.754+0000] {logging_mixin.py:188} INFO - 
--- Primeros 10 registros de los datos pivoteados ---
[2025-11-14T02:50:32.794+0000] {logging_mixin.py:188} INFO -   Id_donante      Método_Pago    Estrategia  ...  2025-03  2025-04  2025-05
0    D000001  Tarjeta Crédito  Face to Face  ...   8000.0   8000.0   8000.0
1    D000002  Tarjeta Crédito  Face to Face  ...      0.0      0.0      0.0
2    D000003  Tarjeta Crédito  Face to Face  ...      0.0      0.0      0.0
3    D000004  Tarjeta Crédito  Face to Face  ...   9000.0   9000.0   9000.0
4    D000005       Cuenta Rut  Face to Face  ...      0.0   9000.0   9000.0
5    D000006     Cuenta Vista  Face to Face  ...  10000.0  10000.0  10000.0
6    D000007       Cuenta Rut  Face to Face  ...  24000.0      0.0      0.0
7    D000008       Cuenta Rut  Face to Face  ...      0.0  10000.0      0.0
8    D000009  Tarjeta Crédito  Face to Face  ...      0.0      0.0      0.0
9    D000010       Cuenta Rut  Face to Face  ...      0.0      0.0      0.0

[10 rows x 29 columns]
[2025-11-14T02:50:32.919+0000] {logging_mixin.py:188} INFO - 
✓ Datos procesados y guardados en: /opt/***/scripts/../layer/silver/donantes_silver.parquet
[2025-11-14T02:50:32.927+0000] {logging_mixin.py:188} INFO - ✓ Archivo indicador creado: /opt/***/scripts/../layer/silver/donantes_silver.py
[2025-11-14T02:50:32.928+0000] {logging_mixin.py:188} INFO - 
--- PROCESO SILVER FINALIZADO ---
[2025-11-14T02:50:32.929+0000] {logging_mixin.py:188} INFO - Registros finales: 24000
[2025-11-14T02:50:32.930+0000] {logging_mixin.py:188} INFO - Columnas: ['Id_donante', 'Método_Pago', 'Estrategia', 'Status_Socio', 'Año_Mes_Creacion', '2023-06', '2023-07', '2023-08', '2023-09', '2023-10', '2023-11', '2023-12', '2024-01', '2024-02', '2024-03', '2024-04', '2024-05', '2024-06', '2024-07', '2024-08', '2024-09', '2024-10', '2024-11', '2024-12', '2025-01', '2025-02', '2025-03', '2025-04', '2025-05']
[2025-11-14T02:50:32.943+0000] {python.py:237} INFO - Done. Returned value was:       Id_donante      Método_Pago    Estrategia  ... 2025-03 2025-04  2025-05
0        D000001  Tarjeta Crédito  Face to Face  ...  8000.0  8000.0   8000.0
1        D000002  Tarjeta Crédito  Face to Face  ...     0.0     0.0      0.0
2        D000003  Tarjeta Crédito  Face to Face  ...     0.0     0.0      0.0
3        D000004  Tarjeta Crédito  Face to Face  ...  9000.0  9000.0   9000.0
4        D000005       Cuenta Rut  Face to Face  ...     0.0  9000.0   9000.0
...          ...              ...           ...  ...     ...     ...      ...
23995    D023996       Cuenta Rut  Face to Face  ...     0.0     0.0  10000.0
23996    D023997       Cuenta Rut  Face to Face  ...     0.0     0.0      0.0
23997    D023998       Cuenta Rut  Face to Face  ...     0.0     0.0      0.0
23998    D023999       Cuenta Rut  Face to Face  ...     0.0     0.0  10000.0
23999    D024000       Cuenta Rut  Face to Face  ...     0.0     0.0      0.0

[24000 rows x 29 columns]
[2025-11-14T02:50:32.990+0000] {taskinstance.py:441} INFO - ::group::Post task execution logs
[2025-11-14T02:50:33.198+0000] {taskinstance.py:1206} INFO - Marking task as SUCCESS. dag_id=etl_donaciones_dag, task_id=procesar_silver, run_id=scheduled__2025-11-14T02:47:00+00:00, execution_date=20251114T024700, start_date=20251114T025030, end_date=20251114T025033
[2025-11-14T02:50:33.311+0000] {local_task_job_runner.py:243} INFO - Task exited with return code 0
[2025-11-14T02:50:33.379+0000] {taskinstance.py:3503} INFO - 1 downstream tasks scheduled from follow-on schedule check
[2025-11-14T02:50:33.382+0000] {local_task_job_runner.py:222} INFO - ::endgroup::
